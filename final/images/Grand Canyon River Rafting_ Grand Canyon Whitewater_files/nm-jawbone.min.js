!function(n,o,e){function t(o,e){this.container=n(o),e.selectors&&!e.selector&&(e.selector=e.selectors,delete e.selectors),e.classNames&&!e.className&&(e.className=e.classNames,delete e.classNames),e.elements&&!e.element&&(e.element=e.elements,delete e.elements),e.hooks&&!e.hook&&(e.hook=e.hooks,delete e.hooks),e.timings&&!e.timing&&(e.timing=e.timings,delete e.timings),this.options=n.extend(!0,{},i,e),this.options.selector.jawbone="."+this.options.className.jawbone.split(" ").join("."),this.options.selector.jawboneClose="."+this.options.className.jawboneClose.split(" ").join("."),this.options.selector.jawboneInner="> ."+this.options.className.jawboneInner.split(" ").join("."),this.options.hook.onInit&&"function"==typeof this.options.hook.onInit&&this.onInit.push(this.options.hook.onInit),this.options.hook.onExpand&&"function"==typeof this.options.hook.onExpand&&this.onExpand.push(this.options.hook.onExpand),this.options.hook.onCollapse&&"function"==typeof this.options.hook.onCollapse&&this.onCollapse.push(this.options.hook.onCollapse),this.options.hook.onRelocate&&"function"==typeof this.options.hook.onRelocate&&this.onRelocate.push(this.options.hook.onRelocate),this.options.hook.onNoRelocate&&"function"==typeof this.options.hook.onNoRelocate&&this.onNoRelocate.push(this.options.hook.onNoRelocate),this.options.hook.onBeginAnimating&&"function"==typeof this.options.hook.onBeginAnimating&&this.onBeginAnimating.push(this.options.hook.onBeginAnimating),this.options.hook.onEndAnimating&&"function"==typeof this.options.hook.onEndAnimating&&this.onEndAnimating.push(this.options.hook.onEndAnimating),this._defaults=i,this.init()}var i={selector:{child:".tile",trigger:".button",jawboneContent:".details"},className:{active:"active",animating:"animating",initialized:"jawboned",jawbone:"jawbone",jawboneClose:"js-jawbone-close",jawboneInner:"inner"},element:{jawboneClose:'<button type="button" class="plain button button-close"><span class="fa fa-times"></span><span class="sr-only"> Close Jawbone</span></button>'},hook:{onInit:null,onCollapse:null,onExpand:null,onRelocate:null,onNoRelocate:null,onBeginAnimating:null,onEndAnimating:null},timing:{collapse:400,expand:400},triggerShouldToggle:!0,useAsyncMethods:!0};t.prototype={container:!1,children:!1,triggers:!1,jawbone:!1,activeChild:!1,previousChild:!1,isJawboneOpen:null,isAnimating:null,onInit:[],onCollapse:[],onExpand:[],onRelocate:[],onNoRelocate:[],onBeginAnimating:[],onEndAnimating:[],init:function(){var n=this;if(n.children=n.container.find(n.options.selector.child),n.triggers=n.container.find(n.options.selector.trigger),n.bindTriggers(),n.isJawboneOpen=!1,n.isAnimating=!1,0==n.container.find(n.options.selector.jawbone).length&&n.create(),n.bindJawboneClose(),n.container.addClass(n.options.className.initialized),n.onInit.length>0)for(var o=0,e=n.onInit.length;e>o;o++)n.onInit[o](n)},create:function(){var o=this,e=n("<div />").addClass(o.options.className.jawbone).css("display","none"),t=n("<div />").addClass(o.options.className.jawboneInner),i=n(o.options.element.jawboneClose);i.addClass(o.options.className.jawboneClose),i.prependTo(e),e.append(t),o.jawbone=e.prependTo(o.container)},collapse:function(){this._trigger_collapse()},expand:function(){this._trigger_expand()},populate:function(n){var o=this;o.jawbone.find(o.options.selector.jawboneInner).html(n)},relocate:function(n,o){var e=this;return o=o||!1,o||(o=e.getLastChildInRow(n)),e.jawboneNeedsToMove(o)?(e.jawbone.detach().insertAfter(o),e.callEvent("onRelocate"),!0):!1},getLastChildInRow:function(n){for(var o,e,t=this,i=n,s=i.offset().top;0!=i.length&&(o=i.next(t.options.selector.child),0!=o.length)&&(e=o.offset().top,!(e>s));)i=o,s=e;return i},jawboneNeedsToMove:function(n){var o=this;return n.next().hasClass(o.options.className.jawbone)?!1:!0},bindJawboneClose:function(){var n=this;n.container.on("click",n.options.selector.jawboneClose,function(o){o.preventDefault(),n._async_Collapse()})},bindTriggers:function(){var o=this;o.triggers.on("click",function(e){if(e.preventDefault(),!o.options.useAsyncMethods||!o.isAnimating){var t=n(this).closest(o.options.selector.child);if(o.previousChild=o.activeChild,o.activeChild=t,o.isJawboneOpen&&o.activeChild.hasClass(o.options.className.active))return o.options.triggerShouldToggle?void o._async_Collapse():void 0;var i=o.getLastChildInRow(o.activeChild),s=o.jawboneNeedsToMove(i);o.isJawboneOpen?s?o._async_CollapseRelocatePopulateAndExpand():o._async_CollapsePopulateAndExpand():s?o._async_RelocatePopulateAndExpand():o._async_PopulateAndExpand()}})},callEvent:function(n){var o=this;if("undefined"==typeof o[n]||"object"!=typeof o[n])return void console.logError("Invalid event called: "+n);if(o[n].length>0)for(var e=0,t=o[n].length;t>e;e++)o[n][e](o)},_trigger_collapse:function(){var n=this;n.options.useAsyncMethods?n.jawbone.slideUp(n.options.timing.collapse,function(){n.isJawboneOpen=!1,n.children.removeClass(n.options.className.active),n.callEvent("onCollapse")}):(n.isJawboneOpen=!1,n.jawbone.slideUp(n.options.timing.collapse),n.children.removeClass(n.options.className.active),n.callEvent("onCollapse"))},_trigger_relocate:function(){this.relocate(this.activeChild)},_trigger_populate:function(){var n=this,o="",e=n.activeChild.find(n.options.selector.jawboneContent);e.length>0&&(o=e.html()),n.populate(o)},_trigger_expand:function(){var n=this;n.options.useAsyncMethods?n.jawbone.slideDown(n.options.timing.expand,function(){n.isJawboneOpen=!0,n.activeChild.addClass(n.options.className.active),n.callEvent("onExpand")}):(n.isJawboneOpen=!0,n.activeChild.addClass(n.options.className.active),n.jawbone.slideDown(n.options.timing.expand),n.callEvent("onExpand"))},async_start:function(){var n=this;n.isAnimating=!0,n.container.addClass(n.options.selector.animating),n.callEvent("onBeginAnimating")},async_end:function(){var n=this;setTimeout(function(){n.isAnimating=!1,n.container.removeClass(n.options.selector.animating),n.callEvent("onEndAnimating")},100)},_async_CollapseRelocatePopulateAndExpand:function(){var n=this;n.options.useAsyncMethods?(n.async_start(),n._trigger_collapse(),setTimeout(function(){n._trigger_relocate(),n._trigger_populate(),n._trigger_expand(),setTimeout(function(){n.async_end()},n.options.timing.expand)},n.options.timing.collapse)):(n._trigger_collapse(),n._trigger_relocate(),n._trigger_populate(),n._trigger_expand())},_async_CollapsePopulateAndExpand:function(){var n=this;n.options.useAsyncMethods?(n.async_start(),n._trigger_collapse(),setTimeout(function(){n._trigger_populate(),n._trigger_expand(),n.callEvent("onNoRelocate"),setTimeout(function(){n.async_end()},n.options.timing.expand)},n.options.timing.collapse)):(n._trigger_collapse(),n._trigger_populate(),n._trigger_expand(),n.callEvent("onNoRelocate"))},_async_RelocatePopulateAndExpand:function(){var n=this;n.options.useAsyncMethods?(n.async_start(),n._trigger_relocate(),n._trigger_populate(),n._trigger_expand(),setTimeout(function(){n.async_end()},n.options.timing.expand)):(n._trigger_relocate(),n._trigger_populate(),n._trigger_expand())},_async_PopulateAndExpand:function(){var n=this;n.options.useAsyncMethods?(n.async_start(),n._trigger_populate(),n._trigger_expand(),n.callEvent("onNoRelocate"),setTimeout(function(){n.async_end()},n.options.timing.expand)):(n._trigger_populate(),n._trigger_expand(),n.callEvent("onNoRelocate"))},_async_Collapse:function(){var n=this;n.options.useAsyncMethods?(n.async_start(),n._trigger_collapse(),setTimeout(function(){n.async_end()},n.options.timing.expand)):n._trigger_collapse()}},n.fn.jawbone=function(o){return o=o||{},this.each(function(){n.data(this,"plugin_jawbone")||n.data(this,"plugin_jawbone",new t(this,o))})}}(jQuery,window,document);
